{
  "hash": "500ca85b9a814ae0fb310ea168df3c09",
  "result": {
    "engine": "knitr",
    "markdown": "# Simple Linear Regression {#sec-sl-reg}\n\n::: callout-note\n#### Packages Used\n\nThis chapter uses the following packages:\n[ggplot2](https://ggplot2.tidyverse.org), [ggdist](https://mjskay.github.io/ggdist/index.html), \n[sjPlot](https://strengejacke.github.io/sjPlot/),\n[gridExtra](https://cran.r-project.org/web/packages/gridExtra/index.html), \n[broom](https://broom.tidymodels.org),\n[performance](https://easystats.github.io/performance/),\nand the [Lung function](https://www.norcalbiostat.com/data/#Lung_Function) dataset.\n:::\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\nThe goal of linear regression is to describe the relationship between an independent variable X and a continuous dependent variable $Y$ as a straight line. \n\nData for this type of model can arise in two ways; \n  \n* Fixed-$X$: values of $X$ are preselected by investigator\n* Variable-$X$: have random sample of $(X,Y)$ values\n    \n    \nBoth Regression and Correlation can be used for two main purposes: \n\n* **Descriptive**: Draw inferences regarding the relationship \n* **Predictive**: Predict value of $Y$ for a given value of $X$\n\nSimple Linear Regression is an example of a Bivariate analysis since there is only one covariate (explanatory variable) under consideration.  \n \n\n## Example {#sec-slr-fev}\n\n::: {.callout-tip appearance=minimal}\nLung function data were obtained from an epidemiological study of households living in four areas with different amounts and types of air pollution. The data set used in this book is a subset of the total data. In this chapter we use only the data taken on the fathers, all of whom are nonsmokers (see PMA6 Appendix A for more details). \n:::\n\nOne of the major early indicators of reduced respiratory function is FEV1 or forced expiratory volume in the first second (amount of air exhaled in 1 second). Since it is known that taller males tend to have higher FEV1, we wish to determine the relationship between height and FEV1. We can use regression analysis for both a descriptive and predictive purpose. \n\n* **Descriptive**: Describing the relationship between FEV1 and height\n* **Predictive**: Use the equation to determine expected or normal FEV1 for a given height\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(fev, aes(y=FFEV1, x=FHEIGHT)) + geom_point() + \n      xlab(\"Height\") + ylab(\"FEV1\") + \n      ggtitle(\"Scatterplot and Regression line of FEV1 Versus Height for Males.\") + \n      geom_smooth(method=\"lm\", se=FALSE, col=\"blue\") \n```\n\n::: {.cell-output-display}\n![](sl_reg_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\nIn this graph, height is given on the horizontal axis since it is the independent or predictor variable and FEV1 is given on the vertical axis since it is the dependent or outcome variable.\n\n**Interpretation**: There does appear to be a tendency for taller men to have higher FEV1. The **regression line** is also added to the graph. The line is tilted upwards, indicating that we expect larger values of FEV1 with larger values of height.\n\nSpecifically the equation of the regression line is \n$$\nY = -4.087 + 0.118 X\n$$\n\nThe quantity 0.118 in front of $X$ is greater than zero, indicating that as we increase $X, Y$ will increase. For example, we would expect a father who is 70 inches tall to have an FEV1 value of\n\n$$\\mbox{FEV1} = -4.087 + (0.118) (70) = 4.173$$\n\nIf the height was 66 inches then we would expect an FEV1 value of only 3.70.\n\n::: {.callout-caution}\n## Caution on out of range predictions\n\nTo take an extreme example, suppose a father was 2 feet tall. Then the equation would predict a negative value of FEV1 ($-1.255$).\n\nA safe policy is to restrict the use of the equation to the range of the $X$ observed in the sample.\n\n:::\n\n## Mathematical Model {#sec-mathematical-model}\n\nThe mathematical model that we use for regression has three features.\n\n1. $Y$ values are normally distributed at any given $X$ \n2. The mean of $Y$ values at any given $X$ follows a straight line $Y = \\beta_{0} + \\beta_{1} X$. \n2. The variance of $Y$ values at any $X$ is $\\sigma^2$ (same for all X). This is known as _homoscedasticity_, or _homogeneity of variance_. \n\n\nMathematically this is written as: \n\n$$\nY|X \\sim N(\\mu_{Y|X}, \\sigma^{2}) \\\\\n\\mu_{Y|X} = \\beta_{0} + \\beta_{1} X \\\\\nVar(Y|X) = \\sigma^{2} \n$$\n\nand can be visualized as: \n\n![Figure 6.2](images/slr_graph.png)",
    "supporting": [
      "sl_reg_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
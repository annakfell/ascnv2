{
  "hash": "a8dd41350d8121f36e02f998e9b2e71e",
  "result": {
    "engine": "knitr",
    "markdown": "# Multiple Linear Regression {#sec-mlr}\n\nHopefully by now you have some motivation for why we need to have a robust model that can incorporate information from multiple variables at the same time. Multiple linear regression is our tool to expand our MODEL to better fit the DATA. \n\n* Extends simple linear regression.\n* Describes a linear relationship between a single continuous $Y$ variable, and several $X$ variables.\n* Predicts $Y$ from $X_{1}, X_{2}, \\ldots , X_{P}$.\n* X's can be continuous or discrete (categorical)\n* X's can be transformations of other X's, e.g., $log(x), x^{2}$. \n\n\nNow it's no longer a 2D regression _line_, but a $p$ dimensional regression plane. \n\n![](images/regression_plane.png)\n\n>This section uses functions from the `dotwhisker` and `gtsummary` visualize results from multiple regression models. \n\n::: callout-note\n#### Packages Used\n\nThis chapter uses the following packages:\n[gtsummary](https://www.danieldsjoberg.com/gtsummary/), \n[performance](https://easystats.github.io/performance/),\n[broom](https://broom.tidymodels.org), \n[knitr](https://yihui.org/knitr/#overview),\n[dotwhisker](https://fsolt.org/dotwhisker/)\n:::\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n## Mathematical Model\n\nThe mathematical model for multiple linear regression equates the value of the continuous outcome $y_{i}$ to a **linear combination** of multiple predictors $x_{1} \\ldots x_{p}$ each with their own slope coefficient $\\beta_{1} \\ldots \\beta_{p}$. \n\n$$ y_{i} = \\beta_{0} + \\beta_{1}x_{1i} + \\ldots + \\beta_{p}x_{pi} + \\epsilon_{i}$$\n\nwhere $i$ indexes the observations $i = 1 \\ldots n$, and $j$ indexes the number of parameters $j=1 \\ldots p$. This linear combination is often written using _summation notation_: $\\sum_{i=1}^{p}X_{ij}\\beta_{j}$. \n\nThe assumptions on the residuals $\\epsilon_{i}$ still hold:   \n\n* They have mean zero  \n* They are homoscedastic, that is all have the same finite variance: $Var(\\epsilon_{i})=\\sigma^{2}<\\infty$  \n* Distinct error terms are uncorrelated (Independent): $\\text{Cov}(\\epsilon_{i},\\epsilon_{j})=0,\\forall i\\neq j.$  \n\n\nIn matrix notation the linear combination of $X$'s and $\\beta$'s is written as $\\mathbf{x}_{i}^{'}\\mathbf{\\beta}$, (the inner product between the vectors $\\mathbf{x}_{i}$ and $\\mathbf{\\beta}$). Then the model is written as: \n\n$$ \\textbf{y} = \\textbf{X} \\mathbf{\\beta} + \\mathbf{\\epsilon} ,$$ \n\nand we say the regression model relates $y$ to a function of $\\textbf{X}$ and $\\mathbf{\\beta}$, where $\\textbf{X}$ is a $n \\times p$ matrix of $p$ covariates on $n$ observations and $\\mathbf{\\beta}$ is a length $p$ vector of regression coefficients.\n\n_Note: Knowledge of Matricies or Linear Algebra is not required to conduct or understand multiple regression, but it is foundational and essential for Statistics and Data Science majors to understand the theory behind linear models._\n\n_Learners in other domains should attempt to understand matricies at a high level, as some of the places models can fail is due to problems doing math on matricies._\n\n## Parameter Estimation\n\nRecall the goal of regression analysis is to minimize the unexplained/residual error. That is, to minimize the difference between the value of the dependent variable predicted by the model and the true value of the dependent variable.\n\n$$ \\hat{y_{i}} - y_{i}, $$\n\nwhere the predicted values $\\hat{y}_{i}$ are calculated as \n\n$$\\hat{y}_{i}  = \\sum_{i=1}^{p}X_{ij}\\beta_{j}$$\n\nThe sum of the squared residual errors (the distance between the observed point $y_{i}$ and the fitted value) now has the following form: \n\n$$ \\sum_{i=1}^{n} |y_{i} - \\sum_{i=1}^{p}X_{ij}\\beta_{j}|^{2}$$\n\nOr in matrix notation\n\n$$ || \\mathbf{Y} - \\mathbf{X}\\mathbf{\\beta} ||^{2} $$ \n\nSolving this least squares problem for multiple regression requires knowledge of multivariable calculus and linear algebra, and so is left to a course in mathematical statistics. \n\n## Fitting the model\n\nThe analysis in example @sec-slr-fev concluded that FEV1 in fathers significantly increases by 0.12 (95% CI:0.09, 0.15) liters per additional inch in height (p<.0001). Looking at the multiple $R^{2}$ (correlation of determination), this simple model explains 25% of the variance seen in the outcome $y$. \n\nHowever, FEV tends to decrease with age for adults, so we should be able to predict it better if we use both height and age as independent variables in a multiple regression equation. \n\n::: {.callout-caution}\n## Think about it\nWhat direction do you expect the slope coefficient for age to be? For height?\n:::\n\nFitting a regression model in R with more than 1 predictor is done by adding each variable to the right hand side of the model notation connected with a `+`. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(FFEV1 ~ FAGE + FHEIGHT, data=fev)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = FFEV1 ~ FAGE + FHEIGHT, data = fev)\n\nCoefficients:\n(Intercept)         FAGE      FHEIGHT  \n   -2.76075     -0.02664      0.11440  \n```\n\n\n:::\n:::\n\n\n\n\n\n## Interpreting Coefficients\n\nSimilar to simple linear regression, each $\\beta_{j}$ coefficient is considered a slope. That is, the amount $Y$ will change for every 1 unit increase in $X_{j}$. In a multiple variable regression model, $b_{j}$ is the estimated change in $Y$ _after controlling for other predictors in the model_. \n\n### Continuous predictors\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmlr.dad.model <- lm(FFEV1 ~ FAGE + FHEIGHT, data=fev)\nsummary(mlr.dad.model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = FFEV1 ~ FAGE + FHEIGHT, data = fev)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.34708 -0.34142  0.00917  0.37174  1.41853 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -2.760747   1.137746  -2.427   0.0165 *  \nFAGE        -0.026639   0.006369  -4.183 4.93e-05 ***\nFHEIGHT      0.114397   0.015789   7.245 2.25e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.5348 on 147 degrees of freedom\nMultiple R-squared:  0.3337,\tAdjusted R-squared:  0.3247 \nF-statistic: 36.81 on 2 and 147 DF,  p-value: 1.094e-13\n```\n\n\n:::\n\n```{.r .cell-code}\nconfint(mlr.dad.model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  2.5 %      97.5 %\n(Intercept) -5.00919751 -0.51229620\nFAGE        -0.03922545 -0.01405323\nFHEIGHT      0.08319434  0.14559974\n```\n\n\n:::\n:::\n\n\n\n\n* Holding height constant, a father who is one year older is expected to have a FEV value 0.03 (0.01, 0.04) liters less than another man (p<.0001).\n* Holding age constant, a father who is 1cm taller than another man is expected to have a FEV value of 0.11 (.08, 0.15) liter greater than the other man (p<.0001). \n\nFor the model that includes age, the coefficient for height is now 0.11, which is interpreted as the rate of change of FEV1 as a function of height **after adjusting for age**. This is also called the **partial regression coefficient** of FEV1 on height after adjusting for age. \n\n\n### Binary predictors\n\nBinary predictors (categorical variables with only 2 levels) get converted to a numeric _binary indicator_ variable which only has the values 0 and 1. Whichever level gets assigned to be 0 is called the _reference_ group or level. The regression estimate $b$ then is the effect of being in group ($x=1$) _compared to_ being in the reference ($x=0$) group.\n\nDoes gender also play a roll in FEV? Let's look at how gender may impact or change the relationship between FEV and either height or age. \n\n> Note, the `fev` data set is in _wide_ form right now, with different columns for mothers and fathers. First I need to reshape the data into _long_ format, so gender is it's own variable. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# a pivot_longer() probably would have worked here as well\nfev_long <- data.frame(gender = c(fev$FSEX, fev$MSEX), \n                   fev1 = c(fev$FFEV1, fev$MFEV1), \n                   ht = c(fev$FHEIGHT, fev$MHEIGHT), \n                   age = c(fev$FAGE, fev$MAGE), \n                   area = c(fev$AREA, fev$AREA))\nfev_long$gender <- factor(fev_long$gender, labels=c(\"M\", \"F\"))\nfev_long$area   <- factor(fev_long$area, labels=c(\"Burbank\", \"Lancaster\", \"Long Beach\", \"Glendora\"))\n```\n:::\n\n\n\n\nSo the model being fit looks like: \n\n$$ y_{i} = \\beta_{0} + \\beta_{1}x_{1i} + \\beta_{2}x_{2i} +\\beta_{3}x_{3i} + \\epsilon_{i}$$\n\nwhere \n\n* $x_{1}$: Age\n* $x_{2}$: height\n* $x_{3}$: 0 if Male, 1 if Female\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(fev1 ~ age + ht + gender, data=fev_long)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = fev1 ~ age + ht + gender, data = fev_long)\n\nCoefficients:\n(Intercept)          age           ht      genderF  \n   -2.24051     -0.02354      0.10509     -0.63775  \n```\n\n\n:::\n:::\n\n\n\n\nIn this model gender is a binary categorical variable, with reference group \"Male\". This is detected because the variable that shows up in the regression model output is `genderF`. So the estimate shown is for males, compared to females. \n\nNote that I **DID NOT** have to convert the categorical variable `gender` to a binary numeric variable before fitting it into the model. R (and any other software program) will do this for you already. \n\n\nThe regression equation for the model with gender is \n\n$$ y = -2.24 - 0.02 age + 0.11 height - 0.64genderF $$\n\n\n* $b_{0}:$ For a male who is 0 years old and 0 cm tall, their FEV is -2.24L.\n* $b_{1}:$ For every additional year older an individual is, their FEV1 decreases by 0.02L. \n* $b_{2}:$ For every additional cm taller an individual is, their FEV1 increases by 0.16L. \n* $b_{3}:$ Females have 0.64L lower FEV compared to males. \n\n**Note**: The interpretation of categorical variables still falls under the template language of \"for every one unit increase in $X_{p}$, $Y$ changes by $b_{p}$\". Here, $X_{3}=0$ for males, and 1 for females. So a 1 \"unit\" change is females _compared to_ males. \n\n\n\n### Categorical Predictors {#sec-cat-predictors}\n\nLet's continue to model the FEV for individuals living in Southern California, but now we also consider the effect of city they live in. For those unfamiliar with the region, these cities represent very different environmental profiles. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(fev_long$area)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   Burbank  Lancaster Long Beach   Glendora \n        48         98         38        116 \n```\n\n\n:::\n:::\n\n\n\n\nLet's fit a model with `area`, notice again I do not do anything to the variable `area` itself aside from add it into the model. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(fev1 ~ age + ht + gender + area, data=fev_long) |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = fev1 ~ age + ht + gender + area, data = fev_long)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.32809 -0.29573  0.00578  0.31588  1.37041 \n\nCoefficients:\n                Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    -2.250564   0.752414  -2.991  0.00302 ** \nage            -0.022801   0.004151  -5.493 8.59e-08 ***\nht              0.103866   0.010555   9.841  < 2e-16 ***\ngenderF        -0.642168   0.078400  -8.191 8.10e-15 ***\nareaLancaster   0.031549   0.084980   0.371  0.71072    \nareaLong Beach  0.061963   0.104057   0.595  0.55199    \nareaGlendora    0.121589   0.082097   1.481  0.13967    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4777 on 293 degrees of freedom\nMultiple R-squared:  0.6529,\tAdjusted R-squared:  0.6458 \nF-statistic: 91.86 on 6 and 293 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n\nExamine the coefficient names, `areaLancaster`, `areaLong Beach` and `areaGlendora`. Again R automatically take a categorical variable and turn it into a series of binary indicator variables where a 1 indicates if a person is from that area. Notice how someone from Burbank has 0's for all of the three indicator variables, someone from Lancaster only has a 1 in the `areaLancaster` variable and 0 otherwise. And etc. for each other area.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|    | areaLancaster| areaLong.Beach| areaGlendora|area       |\n|:---|-------------:|--------------:|------------:|:----------|\n|1   |             0|              0|            0|Burbank    |\n|51  |             1|              0|            0|Lancaster  |\n|75  |             0|              1|            0|Long Beach |\n|101 |             0|              0|            1|Glendora   |\n\n\n:::\n:::\n\n\n\n\n* Most commonly known as \"Dummy coding\". Not an informative term to use. \n* Better used term: Indicator variable\n* Math notation: **I(gender == \"Female\")**. \n* A.k.a \"reference coding\" or \"one hot encoding\"\n* For a nominal X with K categories, define K indicator variables.\n    - Choose a reference (referent) category:\n    - Leave it out\n    - Use remaining K-1 in the regression.\n    - Often, the largest category is chosen as the reference category.\n\nInterpreting the regression coefficients are going to be **compared to the reference group**. In this case, it is the Burbank area. Why Burbank? Because that is what R sees as the first level. If you want something different, you need to change the factor ordering. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlevels(fev_long$area)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Burbank\"    \"Lancaster\"  \"Long Beach\" \"Glendora\"  \n```\n\n\n:::\n:::\n\n\n\n\nThe mathematical model is now written as follows, \n\n$$ Y_{i} = \\beta_{0} + \\beta_{1}x_{1i} + \\beta_{2}x_{2i} +\\beta_{3}x_{3i} + \\beta_{4}x_{4i} + \\beta_{5}x_{5i} +\\beta_{6}x_{6i}\\epsilon_{i}$$\n\nwhere \n\n* $x_{1}$: Age\n* $x_{2}$: height\n* $x_{3}$: 0 if Male, 1 if Female\n* $x_{4}$: 1 if living in Lancaster, 0 otherwise \n* $x_{5}$: 1 if living in Long Beach, 0 otherwise\n* $x_{6}$: 1 if living in Glendora, 0 otherwise\n\n\nFor someone living in Burbank, $x_{4}=x_{5}=x_{6} =0$ so the model then is\n\n$$Y_{i} = \\beta_{0} + \\beta_{1}x_{1i} + \\beta_{2}x_{2i} +\\beta_{3}x_{3i} + \\epsilon_{i}$$\n\nFor someone living in Lancaster, $x_{4}=1, x_{5}=0, x_{6} =0$ so the model then is\n\n$$ \nY_{i} = \\beta_{0} + \\beta_{1}x_{1i} + \\beta_{2}x_{2i} +\\beta_{3}x_{3i} + \\beta_{4}(1) \\\\\nY_{i} \\sim (\\beta_{0} + \\beta_{4}) + \\beta_{1}x_{i} + \\beta_{2}x_{2i} +\\beta_{3}x_{3i} \\epsilon_{i}\n$$\n\nFor someone living in Long Beach, $x_{4}=0, x_{5}=1, x_{6} =0$ so the model then is\n\n$$ \nY_{i} = \\beta_{0} + \\beta_{1}x_{1i} + \\beta_{2}x_{2i} +\\beta_{3}x_{3i} + \\beta_{5}(1) \\\\\nY_{i} \\sim (\\beta_{0} + \\beta_{5}) + \\beta_{1}x_{i} + \\beta_{2}x_{2i} +\\beta_{3}x_{3i} \\epsilon_{i}\n$$\n\n\nand the model for someone living in Glendora $x_{4}=0, x_{5}=0, x_{6} =1$ is\n\n$$ \nY_{i} = \\beta_{0} + \\beta_{1}x_{1i} + \\beta_{2}x_{2i} +\\beta_{3}x_{3i} + \\beta_{6}(1) \\\\\nY_{i} \\sim (\\beta_{0} + \\beta_{6}) + \\beta_{1}x_{i} + \\beta_{2}x_{2i} +\\beta_{3}x_{3i} \\epsilon_{i}\n$$\n\n\nIn summary, each area gets it's own intercept, but still has a common slope for all other variables. \n\n$$y_{i.Burbank} = -2.25 - 0.023(age) + 0.10(ht) -0.64(female)$$\n$$y_{i.Lancaster} = -2.22 - 0.023(age) + 0.10(ht) -0.64(female)$$\n$$y_{i.Long.Beach} = -2.19 - 0.023(age) + 0.10(ht) -0.64(female)$$\n$$y_{i.Glendora} = -2.13 - 0.023(age) + 0.10(ht) -0.64(female)$$ \n\nLet's look interpret the regression coefficients and their 95% confidence intervals from the main effects model again. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(fev1 ~ age + ht + gender + area, data=fev_long) |> tbl_regression()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ngdelindea\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ngdelindea table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ngdelindea thead, #ngdelindea tbody, #ngdelindea tfoot, #ngdelindea tr, #ngdelindea td, #ngdelindea th {\n  border-style: none;\n}\n\n#ngdelindea p {\n  margin: 0;\n  padding: 0;\n}\n\n#ngdelindea .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ngdelindea .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ngdelindea .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ngdelindea .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ngdelindea .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ngdelindea .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ngdelindea .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ngdelindea .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ngdelindea .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ngdelindea .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ngdelindea .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ngdelindea .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ngdelindea .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ngdelindea .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ngdelindea .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ngdelindea .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ngdelindea .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ngdelindea .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ngdelindea .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ngdelindea .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ngdelindea .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ngdelindea .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ngdelindea .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ngdelindea .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ngdelindea .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ngdelindea .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ngdelindea .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ngdelindea .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ngdelindea .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ngdelindea .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ngdelindea .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ngdelindea .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ngdelindea .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ngdelindea .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ngdelindea .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ngdelindea .gt_left {\n  text-align: left;\n}\n\n#ngdelindea .gt_center {\n  text-align: center;\n}\n\n#ngdelindea .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ngdelindea .gt_font_normal {\n  font-weight: normal;\n}\n\n#ngdelindea .gt_font_bold {\n  font-weight: bold;\n}\n\n#ngdelindea .gt_font_italic {\n  font-style: italic;\n}\n\n#ngdelindea .gt_super {\n  font-size: 65%;\n}\n\n#ngdelindea .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ngdelindea .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ngdelindea .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ngdelindea .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ngdelindea .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ngdelindea .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ngdelindea .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Beta&lt;/strong&gt;\"><strong>Beta</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;95% CI&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>95% CI</strong><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;p-value&lt;/strong&gt;\"><strong>p-value</strong></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">age</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">-0.02</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-0.03, -0.01</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">ht</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.10</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">0.08, 0.12</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">gender</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"ci\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    M</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">—</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">—</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    F</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">-0.64</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-0.80, -0.49</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">area</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"ci\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Burbank</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">—</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">—</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Lancaster</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.03</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-0.14, 0.20</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.7</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Long Beach</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.06</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-0.14, 0.27</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.6</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Glendora</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.12</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-0.04, 0.28</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.14</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> CI = Confidence Interval</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n* $b_{4}$: After controlling for age, height and gender, those that live in Lancaster have 0.03 (-0.14, 0.20) higher FEV1 compared to someone living in Burbank (p=0.7). \n* $b_{5}$: After controlling for age, height and gender, those that live in Long Beach have 0.06 (-0.14, 0.27) higher FEV1 compared to someone living in Burbank (p=0.6). \n* $b_{6}$: After controlling for age, height and gender, those that live in Glendora have 0.12 (-0.04, 0.28) higher FEV1 compared to someone living in Burbank (p=0.14). \n\nBeta coefficients for categorical variables are always interpreted as the difference between that particular level and the reference group.\n\n## Presenting results\n\nThe direct software output always tells you more information than what you are wanting to share with an audience. Here are some ways to \"prettify\" your regression output. \n\n::: {.panel-tabset}\n## broom + knitr\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(mlr.dad.model) |> kable(digits=3)\n```\n\n::: {.cell-output-display}\n\n\n|term        | estimate| std.error| statistic| p.value|\n|:-----------|--------:|---------:|---------:|-------:|\n|(Intercept) |   -2.761|     1.138|    -2.427|   0.016|\n|FAGE        |   -0.027|     0.006|    -4.183|   0.000|\n|FHEIGHT     |    0.114|     0.016|     7.245|   0.000|\n\n\n:::\n:::\n\n\n\n\n## gtsummary\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntbl_regression(mlr.dad.model)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"gjlowjywsu\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#gjlowjywsu table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#gjlowjywsu thead, #gjlowjywsu tbody, #gjlowjywsu tfoot, #gjlowjywsu tr, #gjlowjywsu td, #gjlowjywsu th {\n  border-style: none;\n}\n\n#gjlowjywsu p {\n  margin: 0;\n  padding: 0;\n}\n\n#gjlowjywsu .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#gjlowjywsu .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#gjlowjywsu .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#gjlowjywsu .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#gjlowjywsu .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gjlowjywsu .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gjlowjywsu .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gjlowjywsu .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#gjlowjywsu .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#gjlowjywsu .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#gjlowjywsu .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#gjlowjywsu .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#gjlowjywsu .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#gjlowjywsu .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#gjlowjywsu .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#gjlowjywsu .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#gjlowjywsu .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#gjlowjywsu .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#gjlowjywsu .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gjlowjywsu .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#gjlowjywsu .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#gjlowjywsu .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#gjlowjywsu .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gjlowjywsu .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#gjlowjywsu .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#gjlowjywsu .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gjlowjywsu .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gjlowjywsu .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#gjlowjywsu .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gjlowjywsu .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#gjlowjywsu .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gjlowjywsu .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gjlowjywsu .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gjlowjywsu .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gjlowjywsu .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gjlowjywsu .gt_left {\n  text-align: left;\n}\n\n#gjlowjywsu .gt_center {\n  text-align: center;\n}\n\n#gjlowjywsu .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#gjlowjywsu .gt_font_normal {\n  font-weight: normal;\n}\n\n#gjlowjywsu .gt_font_bold {\n  font-weight: bold;\n}\n\n#gjlowjywsu .gt_font_italic {\n  font-style: italic;\n}\n\n#gjlowjywsu .gt_super {\n  font-size: 65%;\n}\n\n#gjlowjywsu .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#gjlowjywsu .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#gjlowjywsu .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#gjlowjywsu .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#gjlowjywsu .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#gjlowjywsu .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#gjlowjywsu .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Beta&lt;/strong&gt;\"><strong>Beta</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;95% CI&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>95% CI</strong><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;p-value&lt;/strong&gt;\"><strong>p-value</strong></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">FAGE</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">-0.03</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-0.04, -0.01</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">FHEIGHT</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.11</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">0.08, 0.15</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> CI = Confidence Interval</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\nConsult the [vignette](https://www.danieldsjoberg.com/gtsummary/) for additional ways to modify the output to show measures such as `AIC`, $R^{2}$ and the number of observations being used to fit the model. \n\n## dotwhisker\n\nWith the function `dwplot` in the [dotwhisker](https://cran.r-project.org/web/packages/dotwhisker/vignettes/dotwhisker-vignette.html) package we can create a _forest plot_. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndwplot(mlr.dad.model)\n```\n\n::: {.cell-output-display}\n![](mlr_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n\nFurther improvement on `dwplot` - extract the point estimate & CI into a data table, then add it as a `geom_text` layer. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntext <- data.frame(                               # create a data frame\n  estimate = coef(mlr.dad.model),                 # by extracting the coefficients,\n  CI.low = confint(mlr.dad.model)[,1],            # with their lower\n  CI.high = confint(mlr.dad.model)[,2]) %>%       # and upper confidence interval values\n  round(2)                                        # round digits\n\n# create the string for the label\ntext$label <- paste0(text$estimate, \"(\", text$CI.low, \", \" , text$CI.high, \")\")\n\ntext                                              # view the results to check for correctness\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            estimate CI.low CI.high               label\n(Intercept)    -2.76  -5.01   -0.51 -2.76(-5.01, -0.51)\nFAGE           -0.03  -0.04   -0.01 -0.03(-0.04, -0.01)\nFHEIGHT         0.11   0.08    0.15    0.11(0.08, 0.15)\n```\n\n\n:::\n\n```{.r .cell-code}\ntext <- text[-1, ]                                # drop the intercept row\n\n# ---- create plot ------\nmlr.dad.model %>%                                  # start with a model\n  tidy() %>%                                       # tidy up the output\n  relabel_predictors(\"(Intercept)\" = \"Intercept\",  # convert to sensible names\n                     FAGE = \"Age\", \n                     FHEIGHT = \"Height\") %>% \n  filter(term != \"Intercept\") %>%                  # drop the intercept \n  dwplot() +                                       # create the ggplot \n  geom_text(aes(x=text$estimate, y = term,         # add the estimates and CI's\n                label = text$label), \n            nudge_y = .1) +                        # move it up a smidge\n  geom_vline(xintercept = 0, col = \"grey\",         # add a reference line at 0\n             lty = \"dashed\", linewidth=1.2) +      # make it dashed and a little larger\n  scale_x_continuous(limits = c(-.15, .15))        # expand the x axis limits for readability\n```\n\n::: {.cell-output-display}\n![](mlr_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n\n:::\n\n## Confounding \n\nOne primary purpose of a multivariable model is to assess the relationship between a particular explanatory variable $x$ and your response variable $y$, _after controlling for other factors_. \n\n\n![All the ways covariates can affect response variables](images/confounder.png)\n\nCredit: [A blog about statistical musings](https://significantlystatistical.wordpress.com/2014/12/12/confounders-mediators-moderators-and-covariates/)\n\n\n\n::: {.callout-tip}\n## Learn more\nEasy to read short [article](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4017459/) from a Gastroenterology journal on how to control confounding effects by statistical analysis.\n:::\n\nOther factors (characteristics/variables) could also be explaining part of the variability seen in $y$. \n\n::: {.callout-note}\n## Confounders\nIf the relationship between $x_{1}$ and $y$ is bivariately significant, but then no longer significant once $x_{2}$ has been added to the model, then $x_{2}$ is said to explain, or **confound**, the relationship between $x_{1}$ and $y$.\n:::\n\nSteps to determine if a variable $x_{2}$ is a confounder. \n\n1. Fit a regression model on $y \\sim x_{1}$. \n2. If $x_{1}$ is not significantly associated with $y$, STOP. Re-read the \"IF\" part of the definition of a confounder. \n3. Fit a regression model on $y \\sim x_{1} + x_{2}$. \n4. Look at the p-value for $x_{1}$. One of two things will have happened. \n    - If $x_{1}$ is still significant, then $x_{2}$ does NOT confound (or explain) the relationship between $y$ and $x_{1}$. \n    - If $x_{1}$ is NO LONGER significantly associated with $y$, then $x_{2}$ IS a confounder. \n    \n\nThis means that the third variable is explaining the relationship between the explanatory variable and the response variable.\n        \nNote that this is a two way relationship. The order of $x_{1}$ and $x_{2}$ is invariant. If you were to add $x_{2}$ to the model before $x_{1}$ you may see the same thing occur. That is - both variables are explaining the same portion of the variance in $y$. \n\n<!---\n### Example: Does smoking affect pulse rate? \n\nPrior studies have indicate that smoking is associated with high blood pressure. Is smoking also associated with your pulse rate? \n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\nFirst we consider the bivariate relationship between pulse rate (`H4PR`) and cigarette smoking as measured by the quantity of cigarettes smoked each day during the past 30 days (`H4TO6`). \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(H4PR ~ H4TO6 , data=addhealth) %>% summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = H4PR ~ H4TO6, data = addhealth)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-30.826  -8.548  -0.687   7.258 120.841 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  73.7702     0.4953 148.936  < 2e-16 ***\nH4TO6         0.1389     0.0396   3.507 0.000464 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.56 on 1761 degrees of freedom\n  (4741 observations deleted due to missingness)\nMultiple R-squared:  0.006936,\tAdjusted R-squared:  0.006372 \nF-statistic:  12.3 on 1 and 1761 DF,  p-value: 0.0004644\n```\n\n\n:::\n:::\n\n\n\n\nAs the number of cigarettes smoked each day increases by one, a persons pulse rate significantly increases by 0.13. \n\nHowever, there are more ways to assess the amount someone smokes. Consider a different measure of smoking, \"during the past 30 days, on how many days did you smoke cigarettes?\" (`H4TO5`). So here we are measuring the # of days smoked, not the # of cigarettes per day. If we include both in the model, we note that the earlier measure of smoking `H4TO6` is no longer significant (at the 0.05 level). \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(H4PR ~ H4TO5 +  H4TO6 , data=addhealth) %>% summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = H4PR ~ H4TO5 + H4TO6, data = addhealth)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-31.682  -8.509  -1.014   7.302 120.320 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 72.78932    0.68037 106.985   <2e-16 ***\nH4TO5        0.06870    0.03271   2.101   0.0358 *  \nH4TO6        0.08292    0.04769   1.739   0.0822 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.55 on 1760 degrees of freedom\n  (4741 observations deleted due to missingness)\nMultiple R-squared:  0.00942,\tAdjusted R-squared:  0.008294 \nF-statistic: 8.368 on 2 and 1760 DF,  p-value: 0.0002415\n```\n\n\n:::\n:::\n\n\n\n\nThus, the number of days smoked _confounds_ the relationship between the number of cigarettes smoked per day, and the person's pulse rate. \n\n\n--->\n\n## What to watch out for\n* Representative sample \n* Range of prediction should match observed range of X in sample\n* Use of nominal or ordinal, rather than interval or ratio data\n* Errors-in-variables\n* Correlation does not imply causation \n* Violation of assumptions\n* Influential points\n* Appropriate model\n* Multicollinearity\n\n\n\n\n",
    "supporting": [
      "mlr_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}